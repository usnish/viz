---
layout: default
title: GLO-PRO map
---

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
<script src="http://www.usnish.org/viz/glo-pro/datamaps.world.min.js"></script>
<script src="http://www.usnish.org/viz/data/data.js"></script>
<link rel="stylesheet" href="http://www.usnish.org/viz/css/gpstyle.css">

<div id="new_container">
    <h1>GLO-PRO Essential Cardiac Medicines</h1>
    <div id="map" style="position: relative; width: 1100px; height: 500px;"></div>
</div>
 
    <h3 style="margin-top:50px">Select medicine to visualize:</h3>


<form id="form" style="position=relative;">
    <h4 style="margin-bottom:0px">Statins</h4>
        <input type="radio" name="option" value="atorvastatin_data" checked="checked">atorvastatin<br>
        <input type="radio" name="option" value="simvastatin_data">simvastatin<br>
        <input type="radio" name="option" value="rosuvastatin_data">rosuvastatin<br>
        <input type="radio" name="option" value="lovastatin_data">lovastatin<br>
        <input type="radio" name="option" value="pravastatin_data">pravastatin<br>

    <h4 style="margin-bottom:0px">Beta-blockers</h4>
        <input type="radio" name="option" value="bisprolol_data">bisprolol<br>
        <input type="radio" name="option" value="metoprolol_data">metoprolol<br>
        <input type="radio" name="option" value="carvedilol_data">carvedilol<br>
        <input type="radio" name="option" value="atenolol_data">atenolol<br>
        <input type="radio" name="option" value="propanolol_data">propanolol<br>
        <input type="radio" name="option" value="acetabutalol_data">acetabutalol<br>

    <h4 style="margin-bottom:0px">Calcium-channel blockers</h4>
        <input type="radio" name="option" value="amlodipine_data">amlodipine<br>
        <input type="radio" name="option" value="Nifedipine_data">nifedipine<br>
        <input type="radio" name="option" value="verapamil_data">verapamil<br>
        <input type="radio" name="option" value="diltiazem_data">diltiazem<br>

    <h4 style="margin-bottom:0px">Specialized vasodilators</h4>
        <input type="radio" name="option" value="hydralazine_data">hydralazine<br>

    <h4 style="margin-bottom:0px">Thiazide diuretics</h4>
        <input type="radio" name="option" value="hydrochlorothiazide_data">hydrochlorothiazide<br>
        <input type="radio" name="option" value="chlorthalidone_data">chlorthalidone<br>
        <input type="radio" name="option" value="bendroflumethiazide_data">bendroflumethiazide<br>
        <input type="radio" name="option" value="indapamide_data">indapamide<br>

    <h4 style="margin-bottom:0px">Loop diuretics</h4>
        <input type="radio" name="option" value="furosemide_data">furosemide<br>

    <h4 style="margin-bottom:0px">Salicylates</h4>
        <input type="radio" name="option" value="aspirin_data">aspirin<br>

    <h4 style="margin-bottom:0px">ACE Inhibitors</h4>
        <input type="radio" name="option" value="captopril_data">captopril<br>
        <input type="radio" name="option" value="enalapril_data">enalapril<br>
        <input type="radio" name="option" value="lisinopril_data">lisinopril<br>
        <input type="radio" name="option" value="perindopril_data">perindopril<br>
        <input type="radio" name="option" value="ramipril_data">ramipril<br>

    <h4 style="margin-bottom:0px">Angiotensin receptor blockers</h4>
        <input type="radio" name="option" value="irbesartan_data">irbesartan<br>
        <input type="radio" name="option" value="losartan_data">losartan<br>
        <input type="radio" name="option" value="telmisartan_data">telmisartan<br>
        <input type="radio" name="option" value="candesartan_data">candesartan<br>
        <input type="radio" name="option" value="valsartan_data">valsartan<br>

    <h4 style="margin-bottom:0px">Potassium-sparing diuretics</h4>
        <input type="radio" name="option" value="spironolactone_data">spironolactone<br>


    <h4 style="margin-bottom:0px">Nitrates</h4>
        <input type="radio" name="option" value="isosorbide_dinitrate_data">isosorbide_dinitrate<br>

    <h4 style="margin-bottom:0px">Digoxin</h4>
        <input type="radio" name="option" value="digoxin_data">digoxin<br>

    <h4 style="margin-bottom:0px">Control: Penicillin</h4>
        <input type="radio" name="option" value="penicillin_data">penicillin<br>

</form>
</div>


<script>

    drug = 'atorvastatin'

    var does_does_not = {
        "YES": "does",
        "NO": "does not"
    }

    var starting_data = JSON.parse(JSON.stringify(atorvastatin_data));

    var map = new Datamap({
        element: document.getElementById('map'),
        // fills: {
     //        defaultFill: 'rgba(23,48,210,0.9)' // Any hex, color name or rgb/rgba value
     //    }

        fills: {
            YES: 'green',
            NO: 'red',
            UNKNOWN: '#ddd',
            defaultFill: '#ddd'
        },
        data: starting_data,

         geographyConfig: {
            popupOnHover: true,

            popupTemplate: function(geo, data) {
                return ['<div class="hoverinfo">',
                        '<u>'+geo.properties.name + '</u> ', 
                        '<strong>'+does_does_not[data.fillKey]+'</strong>',' have ' + drug + ' in its national formulary. Last updated ', '<strong>'+ data.updated.toString() + '. </strong>',
                        '</div>'].join('');
            }
        }

    });

    map.legend();

    // // FOR DEBUGGING
    // var countries = Datamap.prototype.worldTopo.objects.world.geometries;

    // for (var i = 0, j = countries.length; i < j; i++) {
    //     console.log(countries[i].id, countries[i].properties.name);
    // }

    d3.selectAll("input[name='option']").on("change", function(){
        drug = this.value.slice(0,-5)
        map.updateChoropleth(eval(this.value));
        console.log();
    });



</script>